<!-- SETUP-AI-MANAGED — regenerated by setup-ai.sh -->

# Project Instructions for Claude Code

## Task Master AI Instructions

**Import Task Master's development workflow commands and guidelines, treat as if import is in the main CLAUDE.md file.**
@./.taskmaster/CLAUDE.md

## Agent Coordination System

When working with tasks via Task Master (MCP), use the three-tier agent system:

- **task-orchestrator**: Analyzes dependencies, identifies parallel work, deploys executors for available tasks, monitors progress.
- **task-executor**: Implements specific tasks/subtasks. Marks work as `review` after completing implementation and self-checks.
- **task-checker**: Quality gate — verifies implementation, tests, and requirements before transitioning `review` → `done`.

## Dependency & Library Management

When installing or adding **any** npm package, pip package, or other dependency:

1. **Prefer `@latest` / no pinned version** — use `npm install <pkg>@latest` (or the equivalent `pip install <pkg>` without version pin) rather than hard-coding a specific version number that may be outdated.
2. **Verify current versions before pinning** — if a specific version IS required (e.g. peer dependency compatibility), use one of these strategies **before** writing the version string:
   - Use the **Context7 MCP** (`resolve-library-id` → `get-library-docs`) to look up current docs and version info.
   - Use **WebFetch** to check the npm registry (`https://registry.npmjs.org/<pkg>/latest`) or PyPI (`https://pypi.org/pypi/<pkg>/json`).
   - Run `npm view <pkg> version` or `pip index versions <pkg>` in the shell.
3. **Never guess versions from training data** — training data is stale. Always confirm via a live lookup.
4. **Lock files are source of truth** — after installing, let `package-lock.json` / `yarn.lock` / `pnpm-lock.yaml` capture the resolved version. Do not manually edit lock files.
5. **Update `package.json` ranges sensibly** — prefer caret ranges (`^`) for libraries, exact versions for critical tooling.

## Task Completion Quality Gate

**Before marking ANY task or subtask as `done` (or transitioning to `review`), you MUST complete ALL of the following steps in order.** Do not skip steps. If any step fails, fix the issue and re-run from that step.

### Mandatory Pre-Completion Checklist

1. **Format / Prettify** — Run the project's configured formatter:
   - `npm run format` or `npx prettier --write .` (JS/TS projects)
   - `black .` or `ruff format .` (Python projects)
   - If no formatter is configured, skip but note it in the subtask update.
2. **Lint** — Run the project's linter and fix all errors (warnings are acceptable):
   - `npm run lint` or `npx eslint . --fix` (JS/TS)
   - `ruff check --fix .` or `flake8` (Python)
3. **Type-check** (if applicable):
   - `npm run typecheck` or `npx tsc --noEmit` (TypeScript projects)
   - `mypy .` or `pyright` (typed Python)
4. **Build** — Run the project's build command and verify zero errors:
   - `npm run build` (JS/TS)
   - `python -m build` or equivalent (Python)
   - If the project has no build step, skip.
5. **Test** — Run the full test suite (or at minimum, tests related to changed files):
   - `npm test` / `npm run test` (JS/TS)
   - `pytest` / `python -m pytest` (Python)
   - If no tests exist yet, write at least basic tests for the implemented functionality before proceeding.
6. **Fix any failures** — If any of steps 1–5 produce errors, fix them and re-run from the failed step.
7. **Log findings** — Use `update_subtask` to record what was done, any issues found and fixed, and confirmation that all checks passed.

### Only Then:
- Call `set_task_status --status=done` (or `--status=review` if using the checker workflow).
- If you cannot make all checks pass, set status to `blocked` and explain the blocker in the subtask update.

> **Rationale:** Code that doesn't format, build, or pass tests is not done. The task-checker agent will reject it anyway — save time by self-checking first.

## Workflow Rules

1. Confirm with the user before proceeding to the next top-level parent task.
2. Use `/clear` between different parent tasks to maintain focus.
3. When starting a new parent task, list its subtasks first. If none exist, call `expand_task` with `--research` flag.
4. On first interaction, confirm which agent to use and ask if the user wants to see current task state.
5. Use `update_subtask` to log implementation findings and progress as you work.

## MCP Servers

@CLAUDE_MCP.md

## Quick Reference

- `task-master list` / MCP `get_tasks` — View all tasks and status
- `task-master next` / MCP `next_task` — Get the next actionable task
- `task-master show <id>` / MCP `get_task` — View task details
- `task-master expand --id=<id> --research` / MCP `expand_task` — Break down a task
- `task-master set-status --id=<id> --status=done` / MCP `set_task_status` — Mark complete
- `task-master update-subtask --id=<id> --prompt="..."` / MCP `update_subtask` — Log progress
